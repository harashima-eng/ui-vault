<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Breadcrumb Navigation</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

:root{
  --bg: oklch(0.13 0.015 260);
  --surface: oklch(0.17 0.02 260);
  --surface-2: oklch(0.21 0.025 260);
  --accent: oklch(0.68 0.16 230);
  --accent-dim: oklch(0.68 0.16 230 / 0.08);
  --accent-hover: oklch(0.60 0.16 230);
  --text: oklch(0.95 0.005 260);
  --text-secondary: oklch(0.60 0.02 260);
  --border: oklch(0.30 0.015 260);
  --radius: 12px;
  --radius-sm: 6px;
  --font: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

body{
  font-family:var(--font);
  background:var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  overflow-x:hidden;
  min-height:100dvh;
}

/* ── Skip Link ── */
.skip-link{
  position:absolute;top:-100%;left:50%;transform:translateX(-50%);
  padding:8px 20px;background:var(--accent);color:var(--bg);
  border-radius:0 0 var(--radius-sm) var(--radius-sm);
  font-weight:600;font-size:14px;z-index:9999;text-decoration:none;
}
.skip-link:focus-visible{top:0;outline:none}

/* ── Page Layout ── */
.page{max-width:860px;width:100%;margin:0 auto;padding:48px 24px 60px}

.page-title{
  font-size:clamp(1.75rem,3vw+0.5rem,2.5rem);
  font-weight:700;letter-spacing:-0.025em;
  line-height:1.15;margin-bottom:8px;
}
.page-subtitle{font-size:15px;color:var(--text-secondary);line-height:1.5;margin-bottom:48px;max-width:55ch}

/* ── Section Blocks ── */
.demo-section{margin-bottom:48px}
.demo-label{
  font-size:11px;font-weight:600;letter-spacing:0.08em;
  text-transform:uppercase;color:var(--accent);
  margin-bottom:16px;
}
.demo-card{
  padding:24px;background:var(--surface);
  border:1px solid var(--border);border-radius:var(--radius);
}

/* ── Breadcrumb Base ── */
.breadcrumb{
  display:flex;align-items:center;flex-wrap:wrap;gap:0;
  list-style:none;font-size:14px;
}
.breadcrumb-item{display:flex;align-items:center;gap:0;position:relative}

/* Separator */
.breadcrumb-sep{
  display:flex;align-items:center;padding:0 8px;
  color:var(--text-secondary);opacity:0.5;flex-shrink:0;
}
.breadcrumb-sep svg{width:12px;height:12px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}

/* Link */
.breadcrumb-link{
  background:none;border:none;font-family:var(--font);
  font-size:inherit;color:var(--text-secondary);
  cursor:pointer;padding:4px 2px;position:relative;
  display:flex;align-items:center;gap:6px;
  white-space:nowrap;max-width:180px;overflow:hidden;text-overflow:ellipsis;
}
.breadcrumb-link:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:2px}

/* Underline element for GSAP */
.breadcrumb-link .underline{
  position:absolute;bottom:0;left:0;right:0;height:1px;
  background:var(--accent);transform-origin:left;
  transform:scaleX(0);
}

/* Current (non-clickable) */
.breadcrumb-current{
  font-weight:700;color:var(--accent);
  padding:4px 2px;white-space:nowrap;
  max-width:200px;overflow:hidden;text-overflow:ellipsis;
}

/* Ellipsis button */
.breadcrumb-ellipsis{
  background:none;border:none;font-family:var(--font);
  font-size:14px;color:var(--text-secondary);
  cursor:pointer;padding:4px 6px;border-radius:var(--radius-sm);
  display:flex;align-items:center;
  position:relative;
}
.breadcrumb-ellipsis:focus-visible{outline:2px solid var(--accent);outline-offset:2px}

/* Ellipsis dropdown */
.ellipsis-dropdown{
  position:absolute;top:calc(100% + 6px);left:0;
  background:var(--surface-2);border:1px solid var(--border);
  border-radius:var(--radius-sm);padding:6px;
  min-width:160px;z-index:100;
  transform-origin:top left;
  opacity:0;transform:scaleY(0);
  pointer-events:none;
  box-shadow:0 8px 24px oklch(0 0 0 / 0.3);
}
.ellipsis-dropdown.open{pointer-events:auto}
.ellipsis-dropdown button{
  display:flex;align-items:center;gap:8px;
  width:100%;padding:8px 10px;
  background:none;border:none;font-family:var(--font);
  font-size:13px;color:var(--text-secondary);
  cursor:pointer;border-radius:4px;text-align:left;
}
.ellipsis-dropdown button:focus-visible{outline:2px solid var(--accent);outline-offset:-2px}
.ellipsis-dropdown button svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;flex-shrink:0}

/* ── Variant: Pill Style ── */
.breadcrumb-pill .breadcrumb-link,
.breadcrumb-pill .breadcrumb-current,
.breadcrumb-pill .breadcrumb-ellipsis{
  padding:6px 14px;border-radius:999px;
  background:var(--surface-2);
}
.breadcrumb-pill .breadcrumb-current{background:var(--accent-dim);color:var(--accent)}
.breadcrumb-pill .breadcrumb-link .underline{display:none}
.breadcrumb-pill .breadcrumb-sep{padding:0 4px}

/* ── Variant: With Icons ── */
.breadcrumb-icons .breadcrumb-link svg,
.breadcrumb-icons .breadcrumb-current-icon{
  width:14px;height:14px;stroke:currentColor;fill:none;
  stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;
  flex-shrink:0;
}

/* ── Tooltip ── */
.tooltip{
  position:absolute;bottom:calc(100% + 8px);left:50%;
  transform:translateX(-50%);
  background:oklch(0.10 0.01 260);
  color:var(--text);
  font-size:12px;font-weight:500;
  padding:6px 12px;border-radius:var(--radius-sm);
  white-space:nowrap;pointer-events:none;
  opacity:0;z-index:200;
  box-shadow:0 4px 12px oklch(0 0 0 / 0.3);
  border:1px solid var(--border);
}
.tooltip::after{
  content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);
  border:5px solid transparent;border-top-color:oklch(0.10 0.01 260);
}

/* ── Content Area ── */
.content-panel{
  margin-top:32px;padding:28px;
  background:var(--surface);border:1px solid var(--border);
  border-radius:var(--radius);min-height:200px;
}
.content-panel h3{font-size:18px;font-weight:700;margin-bottom:8px;letter-spacing:-0.01em}
.content-panel p{font-size:14px;color:var(--text-secondary);line-height:1.6;max-width:55ch}
.content-tags{display:flex;gap:6px;margin-top:16px;flex-wrap:wrap}
.content-tag{
  padding:4px 12px;font-size:12px;font-weight:500;
  background:var(--surface-2);border:1px solid var(--border);
  border-radius:999px;color:var(--text-secondary);
}

/* ── Mobile Breadcrumb ── */
.mobile-breadcrumb{display:none}
.mobile-crumb-btn{
  display:flex;align-items:center;gap:8px;
  background:var(--surface);border:1px solid var(--border);
  border-radius:var(--radius-sm);padding:10px 16px;
  font-family:var(--font);font-size:14px;font-weight:500;
  color:var(--text);cursor:pointer;width:100%;
}
.mobile-crumb-btn:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
.mobile-crumb-btn svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round}
.mobile-crumb-btn .dots{color:var(--text-secondary);margin-right:4px}
.mobile-crumb-list{
  background:var(--surface);border:1px solid var(--border);
  border-radius:var(--radius-sm);margin-top:4px;
  overflow:hidden;max-height:0;opacity:0;
}
.mobile-crumb-item{
  display:flex;align-items:center;gap:10px;
  padding:12px 16px;font-size:14px;
  background:none;border:none;font-family:var(--font);
  color:var(--text-secondary);cursor:pointer;width:100%;
  text-align:left;
}
.mobile-crumb-item:focus-visible{outline:2px solid var(--accent);outline-offset:-2px}
.mobile-crumb-item+.mobile-crumb-item{border-top:1px solid var(--border)}
.mobile-crumb-item.current{color:var(--accent);font-weight:600}
.mobile-crumb-item svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;flex-shrink:0}

@media(max-width:540px){
  .desktop-breadcrumb{display:none}
  .mobile-breadcrumb{display:block}
}

/* ── Reveal state ── */
.reveal{opacity:0;transform:translateY(24px)}
</style>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

<a href="#main-content" class="skip-link">Skip to content</a>

<div class="page" id="main-content">

  <h1 class="page-title reveal">Breadcrumb Navigation</h1>
  <p class="page-subtitle reveal">Hierarchical breadcrumbs with ellipsis collapse, tooltips on truncated items, and smooth GSAP interactions. Click items to navigate.</p>

  <!-- Variant 1: Simple (Chevron Separators) -->
  <div class="demo-section reveal">
    <div class="demo-label">1. Simple &mdash; Chevron Separators</div>
    <div class="demo-card">

      <!-- Desktop -->
      <nav class="desktop-breadcrumb" aria-label="Breadcrumb" data-variant="simple">
        <ol class="breadcrumb" id="bc-simple">
          <li class="breadcrumb-item"><button class="breadcrumb-link" data-page="home">Home</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="products">Products</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="electronics">Electronics</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="headphones">Headphones</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><span class="breadcrumb-current" aria-current="page">Sony WH-1000XM5</span></li>
        </ol>
      </nav>

      <!-- Collapsed variant -->
      <div style="margin-top:20px;padding-top:20px;border-top:1px solid var(--border)">
        <div style="font-size:11px;color:var(--text-secondary);margin-bottom:10px;font-weight:500">Collapsed:</div>
        <nav class="desktop-breadcrumb" aria-label="Breadcrumb (collapsed)">
          <ol class="breadcrumb" id="bc-simple-collapsed">
            <li class="breadcrumb-item"><button class="breadcrumb-link" data-page="home">Home</button></li>
            <li class="breadcrumb-item">
              <span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span>
              <button class="breadcrumb-ellipsis" aria-label="Show hidden levels" aria-expanded="false">
                &hellip;
                <div class="ellipsis-dropdown" id="dd-simple" role="menu">
                  <button role="menuitem" data-page="products">Products</button>
                  <button role="menuitem" data-page="electronics">Electronics</button>
                </div>
              </button>
            </li>
            <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="headphones">Headphones</button></li>
            <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><span class="breadcrumb-current" aria-current="page">Sony WH-1000XM5</span></li>
          </ol>
        </nav>
      </div>

      <!-- Mobile -->
      <div class="mobile-breadcrumb" id="mobile-bc-simple">
        <button class="mobile-crumb-btn" aria-expanded="false">
          <svg viewBox="0 0 16 16"><polyline points="10 3 5 8 10 13"/></svg>
          <span class="dots">&hellip;</span> Sony WH-1000XM5
        </button>
        <div class="mobile-crumb-list">
          <button class="mobile-crumb-item" data-page="home"><svg viewBox="0 0 14 14"><path d="M2 7l5-5 5 5"/><path d="M3 7v5a1 1 0 001 1h6a1 1 0 001-1V7"/></svg>Home</button>
          <button class="mobile-crumb-item" data-page="products">Products</button>
          <button class="mobile-crumb-item" data-page="electronics">Electronics</button>
          <button class="mobile-crumb-item" data-page="headphones">Headphones</button>
          <button class="mobile-crumb-item current" aria-current="page">Sony WH-1000XM5</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Variant 2: Pill Style -->
  <div class="demo-section reveal">
    <div class="demo-label">2. Pill Style &mdash; Rounded Chips</div>
    <div class="demo-card">
      <nav class="desktop-breadcrumb" aria-label="Breadcrumb (pill)">
        <ol class="breadcrumb breadcrumb-pill" id="bc-pill">
          <li class="breadcrumb-item"><button class="breadcrumb-link" data-page="home">Home</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="products">Products</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="electronics">Electronics</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><button class="breadcrumb-link" data-page="headphones">Headphones</button></li>
          <li class="breadcrumb-item"><span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span><span class="breadcrumb-current" aria-current="page">Sony WH-1000XM5</span></li>
        </ol>
      </nav>

      <div class="mobile-breadcrumb" id="mobile-bc-pill">
        <button class="mobile-crumb-btn" aria-expanded="false">
          <svg viewBox="0 0 16 16"><polyline points="10 3 5 8 10 13"/></svg>
          <span class="dots">&hellip;</span> Sony WH-1000XM5
        </button>
        <div class="mobile-crumb-list">
          <button class="mobile-crumb-item" data-page="home">Home</button>
          <button class="mobile-crumb-item" data-page="products">Products</button>
          <button class="mobile-crumb-item" data-page="electronics">Electronics</button>
          <button class="mobile-crumb-item" data-page="headphones">Headphones</button>
          <button class="mobile-crumb-item current" aria-current="page">Sony WH-1000XM5</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Variant 3: With Icons -->
  <div class="demo-section reveal">
    <div class="demo-label">3. With Icons &mdash; Folder / Page Prefix</div>
    <div class="demo-card">
      <nav class="desktop-breadcrumb" aria-label="Breadcrumb (icons)">
        <ol class="breadcrumb breadcrumb-icons" id="bc-icons">
          <li class="breadcrumb-item">
            <button class="breadcrumb-link" data-page="home">
              <svg viewBox="0 0 14 14"><path d="M2 7l5-5 5 5"/><path d="M3 7v5a1 1 0 001 1h6a1 1 0 001-1V7"/></svg>
              Home
            </button>
          </li>
          <li class="breadcrumb-item">
            <span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span>
            <button class="breadcrumb-link" data-page="products">
              <svg viewBox="0 0 14 14"><path d="M2 4.5V12a1 1 0 001 1h8a1 1 0 001-1V4.5"/><path d="M1 4.5L7 1l6 3.5"/></svg>
              Products
            </button>
          </li>
          <li class="breadcrumb-item">
            <span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span>
            <button class="breadcrumb-link" data-page="electronics">
              <svg viewBox="0 0 14 14"><path d="M2 4.5V12a1 1 0 001 1h8a1 1 0 001-1V4.5"/><path d="M1 4.5L7 1l6 3.5"/></svg>
              Electronics
            </button>
          </li>
          <li class="breadcrumb-item">
            <span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span>
            <button class="breadcrumb-link" data-page="headphones">
              <svg viewBox="0 0 14 14"><path d="M2 4.5V12a1 1 0 001 1h8a1 1 0 001-1V4.5"/><path d="M1 4.5L7 1l6 3.5"/></svg>
              Headphones
            </button>
          </li>
          <li class="breadcrumb-item">
            <span class="breadcrumb-sep" aria-hidden="true"><svg viewBox="0 0 12 12"><polyline points="4 2 8 6 4 10"/></svg></span>
            <span class="breadcrumb-current" aria-current="page">
              <svg class="breadcrumb-current-icon" viewBox="0 0 14 14" style="display:inline;vertical-align:-2px;margin-right:4px;width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round"><path d="M8 1H4a1 1 0 00-1 1v10a1 1 0 001 1h6a1 1 0 001-1V4z"/><polyline points="8 1 8 4 11 4"/></svg>Sony WH-1000XM5
            </span>
          </li>
        </ol>
      </nav>

      <div class="mobile-breadcrumb" id="mobile-bc-icons">
        <button class="mobile-crumb-btn" aria-expanded="false">
          <svg viewBox="0 0 16 16"><polyline points="10 3 5 8 10 13"/></svg>
          <span class="dots">&hellip;</span> Sony WH-1000XM5
        </button>
        <div class="mobile-crumb-list">
          <button class="mobile-crumb-item" data-page="home"><svg viewBox="0 0 14 14"><path d="M2 7l5-5 5 5"/><path d="M3 7v5a1 1 0 001 1h6a1 1 0 001-1V7"/></svg>Home</button>
          <button class="mobile-crumb-item" data-page="products"><svg viewBox="0 0 14 14"><path d="M2 4.5V12a1 1 0 001 1h8a1 1 0 001-1V4.5"/><path d="M1 4.5L7 1l6 3.5"/></svg>Products</button>
          <button class="mobile-crumb-item" data-page="electronics"><svg viewBox="0 0 14 14"><path d="M2 4.5V12a1 1 0 001 1h8a1 1 0 001-1V4.5"/><path d="M1 4.5L7 1l6 3.5"/></svg>Electronics</button>
          <button class="mobile-crumb-item" data-page="headphones"><svg viewBox="0 0 14 14"><path d="M2 4.5V12a1 1 0 001 1h8a1 1 0 001-1V4.5"/><path d="M1 4.5L7 1l6 3.5"/></svg>Headphones</button>
          <button class="mobile-crumb-item current" aria-current="page"><svg viewBox="0 0 14 14"><path d="M8 1H4a1 1 0 00-1 1v10a1 1 0 001 1h6a1 1 0 001-1V4z"/><polyline points="8 1 8 4 11 4"/></svg>Sony WH-1000XM5</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Content Panel -->
  <div class="demo-section reveal">
    <div class="demo-label">Content Preview</div>
    <div class="content-panel" id="content-panel">
      <h3 id="content-title">Sony WH-1000XM5</h3>
      <p id="content-desc">Industry-leading noise canceling headphones with Auto NC Optimizer, exceptional sound quality, and crystal-clear hands-free calling. Ultra-comfortable design with 30 hours of battery life.</p>
      <div class="content-tags" id="content-tags">
        <span class="content-tag">Over-ear</span>
        <span class="content-tag">Noise Canceling</span>
        <span class="content-tag">Bluetooth 5.2</span>
        <span class="content-tag">30hr Battery</span>
      </div>
    </div>
  </div>

</div>

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/Flip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/TextPlugin.min.js"></script>
<script src="../animations/gsap-utils.js"></script>
<script>
gsap.registerPlugin(ScrollTrigger, Flip, TextPlugin);

(function () {
  'use strict';

  var reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  /* ── Page content data ── */
  var pageData = {
    'home': { title: 'Home', desc: 'Welcome to the store. Browse our collection of premium electronics, accessories, and more.', tags: ['Featured', 'New Arrivals', 'Best Sellers'] },
    'products': { title: 'Products', desc: 'Explore our full catalog of curated products across all categories. From everyday essentials to premium gear.', tags: ['Electronics', 'Accessories', 'Audio', 'Wearables'] },
    'electronics': { title: 'Electronics', desc: 'High-quality electronics from the world\'s leading brands. Smartphones, laptops, tablets, and audio equipment.', tags: ['Smartphones', 'Laptops', 'Audio', 'Tablets'] },
    'headphones': { title: 'Headphones', desc: 'Premium headphones for every use case. Over-ear, in-ear, sport, and noise-canceling models from top brands.', tags: ['Over-ear', 'In-ear', 'Sport', 'Noise Canceling'] },
    'sony-wh1000xm5': { title: 'Sony WH-1000XM5', desc: 'Industry-leading noise canceling headphones with Auto NC Optimizer, exceptional sound quality, and crystal-clear hands-free calling. Ultra-comfortable design with 30 hours of battery life.', tags: ['Over-ear', 'Noise Canceling', 'Bluetooth 5.2', '30hr Battery'] },
  };

  /* ── Helper: build tag elements safely (no innerHTML) ── */
  function buildTags(container, tagList) {
    while (container.firstChild) container.removeChild(container.firstChild);
    tagList.forEach(function (text) {
      var span = document.createElement('span');
      span.className = 'content-tag';
      span.textContent = text;
      container.appendChild(span);
    });
  }

  /* ── Content panel update ── */
  function updateContent(pageKey) {
    var data = pageData[pageKey];
    if (!data) return;

    var panel = document.getElementById('content-panel');
    var title = document.getElementById('content-title');
    var desc = document.getElementById('content-desc');
    var tags = document.getElementById('content-tags');

    if (!reduced) {
      var tl = gsap.timeline();
      tl.to(panel, { opacity: 0, y: -8, duration: 0.2, ease: 'power2.in' });
      tl.call(function () {
        title.textContent = data.title;
        desc.textContent = data.desc;
        buildTags(tags, data.tags);
      });
      tl.to(panel, { opacity: 1, y: 0, duration: 0.3, ease: 'power2.out' });
    } else {
      title.textContent = data.title;
      desc.textContent = data.desc;
      buildTags(tags, data.tags);
    }
  }

  /* ── Breadcrumb link click: animate out items to the right ── */
  function handleBreadcrumbClick(link, breadcrumbList) {
    var pageKey = link.dataset.page;
    if (!pageKey) return;

    /* Find this item's index and animate siblings to the right */
    var items = Array.from(breadcrumbList.querySelectorAll('.breadcrumb-item'));
    var clickedIndex = -1;
    for (var i = 0; i < items.length; i++) {
      if (items[i].contains(link)) { clickedIndex = i; break; }
    }

    if (clickedIndex >= 0 && !reduced) {
      var rightItems = items.slice(clickedIndex + 1);
      if (rightItems.length) {
        gsap.to(rightItems, {
          opacity: 0, x: 10, duration: 0.25,
          stagger: 0.04, ease: 'power2.in',
          onComplete: function () {
            gsap.set(rightItems, { opacity: 1, x: 0 });
          }
        });
      }
    }

    updateContent(pageKey);
  }

  /* Attach click handlers to all breadcrumb links */
  document.querySelectorAll('.breadcrumb-link').forEach(function (link) {
    link.addEventListener('click', function () {
      var list = link.closest('.breadcrumb');
      handleBreadcrumbClick(link, list);
    });
  });

  /* ── Ellipsis dropdown ── */
  document.querySelectorAll('.breadcrumb-ellipsis').forEach(function (btn) {
    var dropdown = btn.querySelector('.ellipsis-dropdown');
    if (!dropdown) return;

    function openDropdown() {
      btn.setAttribute('aria-expanded', 'true');
      dropdown.classList.add('open');
      if (!reduced) {
        gsap.to(dropdown, { scaleY: 1, opacity: 1, duration: 0.25, ease: 'back.out(1.4)' });
      } else {
        gsap.set(dropdown, { scaleY: 1, opacity: 1 });
      }
    }

    function closeDropdown() {
      btn.setAttribute('aria-expanded', 'false');
      if (!reduced) {
        gsap.to(dropdown, { scaleY: 0, opacity: 0, duration: 0.15, ease: 'power2.in', onComplete: function () { dropdown.classList.remove('open'); } });
      } else {
        gsap.set(dropdown, { scaleY: 0, opacity: 0 });
        dropdown.classList.remove('open');
      }
    }

    btn.addEventListener('click', function (e) {
      if (e.target.closest('.ellipsis-dropdown')) return;
      var isOpen = btn.getAttribute('aria-expanded') === 'true';
      isOpen ? closeDropdown() : openDropdown();
    });

    /* Dropdown item clicks */
    dropdown.querySelectorAll('button').forEach(function (item) {
      item.addEventListener('click', function () {
        closeDropdown();
        updateContent(item.dataset.page);
      });
    });

    /* Close on outside click */
    document.addEventListener('click', function (e) {
      if (!btn.contains(e.target)) closeDropdown();
    });

    /* Close on Escape */
    btn.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') closeDropdown();
    });
  });

  /* ── Hover underline on breadcrumb links ── */
  if (!reduced) {
    document.querySelectorAll('.breadcrumb-link').forEach(function (link) {
      var underline = link.querySelector('.underline');
      /* Add underline span if not pill variant */
      if (!underline && !link.closest('.breadcrumb-pill')) {
        underline = document.createElement('span');
        underline.className = 'underline';
        underline.setAttribute('aria-hidden', 'true');
        link.appendChild(underline);
        gsap.set(underline, { scaleX: 0 });
      }

      link.addEventListener('mouseenter', function () {
        gsap.to(link, { color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim(), duration: 0.12, ease: 'power2.out' });
        if (underline) {
          gsap.to(underline, { scaleX: 1, duration: 0.2, ease: 'power2.out' });
        }
      });
      link.addEventListener('mouseleave', function () {
        gsap.to(link, { color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim(), duration: 0.12, ease: 'power2.out' });
        if (underline) {
          gsap.to(underline, { scaleX: 0, duration: 0.15, ease: 'power2.in' });
        }
      });
    });

    /* Pill variant hover */
    document.querySelectorAll('.breadcrumb-pill .breadcrumb-link').forEach(function (link) {
      link.addEventListener('mouseenter', function () {
        gsap.to(link, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--accent-dim').trim(), duration: 0.12, ease: 'power2.out' });
      });
      link.addEventListener('mouseleave', function () {
        gsap.to(link, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--surface-2').trim(), duration: 0.12, ease: 'power2.out' });
      });
    });

    /* Ellipsis hover */
    document.querySelectorAll('.breadcrumb-ellipsis').forEach(function (btn) {
      btn.addEventListener('mouseenter', function () {
        gsap.to(btn, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--surface-2').trim(), color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim(), duration: 0.12, ease: 'power2.out' });
      });
      btn.addEventListener('mouseleave', function () {
        gsap.to(btn, { backgroundColor: 'transparent', color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim(), duration: 0.12, ease: 'power2.out' });
      });
    });

    /* Dropdown item hovers */
    document.querySelectorAll('.ellipsis-dropdown button').forEach(function (item) {
      item.addEventListener('mouseenter', function () {
        gsap.to(item, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--surface').trim(), color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim(), duration: 0.1, ease: 'power2.out' });
      });
      item.addEventListener('mouseleave', function () {
        gsap.to(item, { backgroundColor: 'transparent', color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim(), duration: 0.1, ease: 'power2.out' });
      });
    });

    /* Content tag hovers via event delegation */
    document.addEventListener('mouseenter', function (e) {
      if (e.target.classList && e.target.classList.contains('content-tag')) {
        gsap.to(e.target, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--accent-dim').trim(), color: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim(), duration: 0.12, ease: 'power2.out' });
      }
    }, true);
    document.addEventListener('mouseleave', function (e) {
      if (e.target.classList && e.target.classList.contains('content-tag')) {
        gsap.to(e.target, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--surface-2').trim(), color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim(), duration: 0.12, ease: 'power2.out' });
      }
    }, true);
  }

  /* ── Tooltips on truncated items ── */
  document.querySelectorAll('.breadcrumb-link, .breadcrumb-current').forEach(function (el) {
    var tooltip = null;

    el.addEventListener('mouseenter', function () {
      /* Only show tooltip if text is truncated */
      if (el.scrollWidth <= el.clientWidth + 2) return;

      tooltip = document.createElement('div');
      tooltip.className = 'tooltip';
      tooltip.textContent = el.textContent.trim();
      tooltip.setAttribute('role', 'tooltip');
      el.style.position = 'relative';
      el.appendChild(tooltip);

      if (!reduced) {
        gsap.fromTo(tooltip, { opacity: 0, y: 4 }, { opacity: 1, y: 0, duration: 0.2, ease: 'power2.out' });
      } else {
        gsap.set(tooltip, { opacity: 1 });
      }
    });

    el.addEventListener('mouseleave', function () {
      if (!tooltip) return;
      var t = tooltip;
      tooltip = null;
      if (!reduced) {
        gsap.to(t, { opacity: 0, duration: 0.1, ease: 'power2.in', onComplete: function () { if (t.parentNode) t.parentNode.removeChild(t); } });
      } else {
        if (t.parentNode) t.parentNode.removeChild(t);
      }
    });
  });

  /* ── Mobile breadcrumb toggle ── */
  document.querySelectorAll('.mobile-crumb-btn').forEach(function (btn) {
    var list = btn.nextElementSibling;
    if (!list) return;

    btn.addEventListener('click', function () {
      var isOpen = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!isOpen));

      if (!reduced) {
        if (!isOpen) {
          gsap.to(list, { maxHeight: 300, opacity: 1, duration: 0.3, ease: 'power2.out' });
        } else {
          gsap.to(list, { maxHeight: 0, opacity: 0, duration: 0.2, ease: 'power2.in' });
        }
      } else {
        gsap.set(list, { maxHeight: isOpen ? 0 : 300, opacity: isOpen ? 0 : 1 });
      }
    });

    /* Mobile item clicks */
    list.querySelectorAll('.mobile-crumb-item').forEach(function (item) {
      item.addEventListener('click', function () {
        if (item.dataset.page) updateContent(item.dataset.page);
        btn.setAttribute('aria-expanded', 'false');
        if (!reduced) {
          gsap.to(list, { maxHeight: 0, opacity: 0, duration: 0.2, ease: 'power2.in' });
        } else {
          gsap.set(list, { maxHeight: 0, opacity: 0 });
        }
      });
    });

    /* Mobile item hovers */
    if (!reduced) {
      list.querySelectorAll('.mobile-crumb-item').forEach(function (item) {
        item.addEventListener('mouseenter', function () {
          gsap.to(item, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--surface-2').trim(), duration: 0.1, ease: 'power2.out' });
        });
        item.addEventListener('mouseleave', function () {
          gsap.to(item, { backgroundColor: 'transparent', duration: 0.1, ease: 'power2.out' });
        });
      });
    }
  });

  /* ── Page entrance animations ── */
  if (!reduced) {
    var reveals = document.querySelectorAll('.reveal');
    gsap.to(reveals, {
      opacity: 1, y: 0, duration: 0.6,
      stagger: 0.08, ease: 'power3.out', delay: 0.1,
    });

    /* Stagger breadcrumb items on load */
    document.querySelectorAll('.breadcrumb').forEach(function (bc) {
      var items = bc.querySelectorAll('.breadcrumb-item');
      gsap.from(items, {
        x: -20, opacity: 0, duration: 0.4,
        stagger: 0.06, ease: 'power2.out', delay: 0.4,
      });
    });
  } else {
    gsap.set('.reveal', { opacity: 1, y: 0 });
  }

  UV.addControlPanel();
})();
</script>
</body>
</html>
